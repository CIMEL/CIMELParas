4 4 1 1 0 0 2      ! key,keyEL,keySUB,keyLS,key_org,key_fx,key_RD1
0.44 1.56 0.0029 0.05 15.0 0.2 4. ! 0.44 1.56 0.0029 6.4809628337211996E-04 33.88174136027241 0.34 0.34  !  WL, RN, RK, rgmin, rgmax, wlmin, wlmax
0 3 2     ! key_SD, ID, NMD
0.00 0.4 0.12 1. 0.6 2.32 !0.04 0.4 0.12 0.4 0.6 2.32 !1. 0.6 2.32 ! CM(1),SM(1),RMM(1)(mkm),CM(2),SM(2),RMM(2)(mkm)Solar-Vil.
22                           ! KN
 5.00000E-2     3.636746667E-3
 6.56037E-2     1.27650341E-2
 8.60768E-2     2.825477906E-2
 0.112939       3.943919018E-2
 0.148184       3.472143412E-2
 0.194429       1.932093687E-2
 0.255105       7.050227374E-3
 0.334716       2.947342116E-3
 0.439172       5.879985634E-3
 0.576226       1.799305901E-2
 0.756052       4.640357196E-2
 0.991995       9.759383649E-2
 1.30157        0.167227194
 1.70776        0.233451143
 2.24070        0.265515089
 2.93996        0.246029273
 3.85745        0.185732767
 5.06126        0.114233799
 6.64074        5.724075064E-2
 8.71314        2.336790785E-2
 11.4323        7.772107143E-3
 15.0           2.106020227E-3
KERNEL_aeronet_n22_83
KERNEL_n22_fix
KERNEL_n22_new
2                     ! KR      
1.	0.1	0.00212	5.01E-04
2.986  0.1
 83
  0.00
  1.71
  3.93
  6.16
  8.39
 10.63
 12.86
 15.10
 17.33
 19.57
 21.80
 24.04
 26.28
 28.51
 30.75
 32.98
 35.22
 37.45
 39.69
 41.93
 44.16
 46.40
 48.63
 50.87
 53.11
 55.34
 57.58
 59.81
 62.05
 64.29
 66.52
 68.76
 70.99
 73.23
 75.47
 77.70
 79.94
 82.17
 84.41
 86.65
 88.88
 90.00
 91.12
 93.35
 95.59
 97.83
100.06
102.30
104.53
106.77
109.01
111.24
113.48
115.71
117.95
120.19
122.42
124.66
126.89
129.13
131.37
133.60
135.84
138.07
140.31
142.55
144.78
147.02
149.25
151.49
153.72
155.96
158.20
160.43
162.67
164.90
167.14
169.37
171.61
173.84
176.07
178.29
180.00

181                       ! KM
0.                        ! ANGLE(KM)
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.
38.
39.
40.
41.
42.
43.
44.
45.
46.
47.
48.
49.
50.
51.
52.
53.
54.
55.
56.
57.
58.
59.
60.
61.
62.
63.
64.
65.
66.
67.
68.
69.
70.
71.
72.
73.
74.
75.
76.
77.
78.
79.
80.
81.
82.
83.
84.
85.
86.
87.
88.
89.
90.
91.
92.
93.
94.
95.
96.
97.
98.
99.
100.
101.
102.
103.
104.
105.
106.
107.
108.
109.
110.
111.
112.
113.
114.
115.
116.
117.
118.
119.
120.
121.
122.
123.
124.
125.
126.
127.
128.
129.
130.
131.
132.
133.
134.
135.
136.
137.
138.
139.
140.
141.
142.
143.
144.
145.
146.
147.
148.
149.
150.
151.
152.
153.
154.
155.
156.
157.
158.
159.
160.
161.
162.
163.
164.
165.
166.
167.
168.
169.
170.
171.
172.
173.
174.
175.
176.
177.
178.
179.
180.
*********************





4 6 0 2 0 0 2      ! key,keyEL,keySUB,keyLS,key_org,key_fx,key_RD1
0.44 1.12 0.0029 0.05 15.0 0.2 4. ! WL, RN, RK, rgmin, rgmax, wlmin, wlmax
1 3 1     ! key_SD, ID, NMD
0.4 0.6 2.32 ! CM(1),SM(1),RMM(1)(mkm),CM(2),SM(2),RMM(2)(mkm)Solar-Vil. 0.04 0.4 0.12 0.4 0.6 2.32
22                           ! KN
 5.00000E-2     3.636746667E-3
 6.56037E-2     1.27650341E-2
 8.60768E-2     2.825477906E-2
 0.112939       3.943919018E-2
 0.148184       3.472143412E-2
 0.194429       1.932093687E-2
 0.255105       7.050227374E-3
 0.334716       2.947342116E-3
 0.439172       5.879985634E-3
 0.576226       1.799305901E-2
 0.756052       4.640357196E-2
 0.991995       9.759383649E-2
 1.30157        0.167227194
 1.70776        0.233451143
 2.24070        0.265515089
 2.93996        0.246029273
 3.85745        0.185732767
 5.06126        0.114233799
 6.64074        5.724075064E-2
 8.71314        2.336790785E-2
 11.4323        7.772107143E-3
 15.0           2.106020227E-3
KERNELr_n35_180_nv
KERNEL_n22_fix
KERNEL_n22_new
25                  ! KR    from Oleg's paper (sum=1.)            
0.3349  0.066185    
0.3669  0.065025
0.4019  0.063635
0.4403  0.06205  
0.4823  0.05872
0.5283  0.05335
0.5787  0.0477625
0.6339  0.042953
0.6944  0.0403205
0.7607  0.
0.8333  0.
0.9129  0.
1.      0.
1.0954  0.
1.2     0.
1.3145  0.
1.44    0.0403205
1.5774  0.042953
1.728   0.0477625
1.8929  0.05335
2.0736  0.05872
2.2715  0.06205
2.48832 0.063635
2.7258  0.065025
2.986   0.066185
180                       ! KM
0.                        ! ANGLE(KM)
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.
38.
39.
40.
41.
42.
43.
44.
45.
46.
47.
48.
49.
50.
51.
52.
53.
54.
55.
56.
57.
58.
59.
60.
61.
62.
63.
64.
65.
66.
67.
68.
69.
70.
71.
72.
73.
74.
75.
76.
77.
78.
79.
80.
81.
82.
83.
84.
85.
86.
87.
88.
89.
90.
91.
92.
93.
94.
95.
96.
97.
98.
99.
100.
101.
102.
103.
104.
105.
106.
107.
108.
109.
110.
111.
112.
113.
114.
115.
116.
117.
118.
119.
120.
121.
122.
123.
124.
125.
126.
127.
128.
129.
130.
131.
132.
133.
134.
135.
136.
137.
138.
139.
140.
141.
142.
143.
144.
145.
146.
147.
148.
149.
150.
151.
152.
153.
154.
155.
156.
157.
158.
159.
160.
161.
162.
163.
164.
165.
166.
167.
168.
169.
170.
171.
172.
173.
174.
175.
176.
177.
178.
179.
180.

35
  0.00
  2.60
  3.46
  5.20
  6.93
  8.66
 10.39
 12.12
 15.57
 17.30
 21.61
 25.90
 30.19
 42.94
 59.57
 67.65
 75.52
 83.12
 97.18
108.94
117.05
120.00
125.00
130.00
135.00
140.00
147.50
154.30
165.00
167.70
170.00
172.50
175.00
177.50
180.00

*********************
4 1 6 0 2 0 0       ! key,key_RD,keyEL,keySUB,keyLS,key_org,key_fx
0.44 1.56 0.0029 0.05 15.0 0.2 4. ! WL, RN, RK, rgmin, rgmax, wlmin, wlmax
1 3 2     ! key_SD, ID, NMD
0.04 0.4 0.12 0.4 0.6 2.32 ! CM(1),SM(1),RMM(1)(mkm),CM(2),SM(2),RMM(2)(mkm)Solar-Vil.
22                           ! KN
 5.00000E-2     3.636746667E-3
 6.56037E-2     1.27650341E-2
 8.60768E-2     2.825477906E-2
 0.112939       3.943919018E-2
 0.148184       3.472143412E-2
 0.194429       1.932093687E-2
 0.255105       7.050227374E-3
 0.334716       2.947342116E-3
 0.439172       5.879985634E-3
 0.576226       1.799305901E-2
 0.756052       4.640357196E-2
 0.991995       9.759383649E-2
 1.30157        0.167227194
 1.70776        0.233451143
 2.24070        0.265515089
 2.93996        0.246029273
 3.85745        0.185732767
 5.06126        0.114233799
 6.64074        5.724075064E-2
 8.71314        2.336790785E-2
 11.4323        7.772107143E-3
 15.0           2.106020227E-3
KERNEL_n22_bin1
KERNEL_n22_fix
KERNEL_n22_new
2                  ! KR    from Oleg's paper (sum=1.)            
1.      1.0    
2.986   1.0
181                       ! KM
0.                        ! ANGLE(KM)
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.
38.
39.
40.
41.
42.
43.
44.
45.
46.
47.
48.
49.
50.
51.
52.
53.
54.
55.
56.
57.
58.
59.
60.
61.
62.
63.
64.
65.
66.
67.
68.
69.
70.
71.
72.
73.
74.
75.
76.
77.
78.
79.
80.
81.
82.
83.
84.
85.
86.
87.
88.
89.
90.
91.
92.
93.
94.
95.
96.
97.
98.
99.
100.
101.
102.
103.
104.
105.
106.
107.
108.
109.
110.
111.
112.
113.
114.
115.
116.
117.
118.
119.
120.
121.
122.
123.
124.
125.
126.
127.
128.
129.
130.
131.
132.
133.
134.
135.
136.
137.
138.
139.
140.
141.
142.
143.
144.
145.
146.
147.
148.
149.
150.
151.
152.
153.
154.
155.
156.
157.
158.
159.
160.
161.
162.
163.
164.
165.
166.
167.
168.
169.
170.
171.
172.
173.
174.
175.
176.
177.
178.
179.
180.
*********************
83
  0.00
  1.71
  3.93
  6.16
  8.39
 10.63
 12.86
 15.10
 17.33
 19.57
 21.80
 24.04
 26.28
 28.51
 30.75
 32.98
 35.22
 37.45
 39.69
 41.93
 44.16
 46.40
 48.63
 50.87
 53.11
 55.34
 57.58
 59.81
 62.05
 64.29
 66.52
 68.76
 70.99
 73.23
 75.47
 77.70
 79.94
 82.17
 84.41
 86.65
 88.88
 90.00
 91.12
 93.35
 95.59
 97.83
100.06
102.30
104.53
106.77
109.01
111.24
113.48
115.71
117.95
120.19
122.42
124.66
126.89
129.13
131.37
133.60
135.84
138.07
140.31
142.55
144.78
147.02
149.25
151.49
153.72
155.96
158.20
160.43
162.67
164.90
167.14
169.37
171.61
173.84
176.07
178.29
180.00

*********************

c **************************************************************** c
c **                                                            ** c
c ** INPUT:                                                     ** c
c **                                                            ** c 
c **   key  = 1 - create fixed kernels (for fixed axis          ** c 
c **              ratio distr.) and save them                   ** c
c **              into 'Rke...fix...' files and calculate       ** c
c **              opt.characteristics                           ** c
c **          2 - read fixed kernels from 'Rke...fix...'  files ** c
c **          3 - create fixed kernels but don't save them      ** c
c **          4 - don't create fixed kernels, calculate         ** c
c **              opt.characteristics from original kernels     ** c
c **   key_RD =1 - volume mixture of spheroids                  ** c
c **           2 - surface area  mixture of spheroids           ** c
c **   keyEL=  1 - calculate F11                                ** c
c **           2 - F11,F12                                      ** c
c **           3 - F11,F12,F22                                  ** c
c **           4 - F11,F12,F22,F33                              ** c
c **           5 - F11,F12,F22,F33,F34                          ** c
c **           6 - F11,F12,F22,F33,F34,F44                      ** c
c **   key_org=0 - read original kernels simultaneously make    ** c 
c **               angle interpolation and calculate opt.char.  ** c
c **           1 -  -"-, save new kernels in                    ** c
c **                /distname_N/ directory, STOP;               ** c
c **                works with key=1                            ** c
c **   key_fx works when key=1                                  ** c
c **        =0 -  create fixed kernels (for fixed axis          ** c 
c **              ratio distr.) and save them                   ** c
c **              into 'Rke...fix...' files and calculate       ** c
c **              opt.characteristics                           ** c
c **         1 - save fixed kernels with original kernel format ** c
c **             in order to be used as input kernels;          ** c
c **             'Rke...fix' kernels have to be renamed and moved* c
c **             into directory 'dir_name'(see 'matrix_fixget.f')* c
c **             The files can not be used if key=2.            ** c
c **                                                            ** c
c **   WL   - wavelength                                        ** c
c **   RN   - real part of the refractive index                 ** c
c **   RK   - imaginary part of the refractive index            ** c
c **   rgmin,rgmax &                                            ** c 
c **   wlmin,wlmax - min,max radii and wlmin,wlmax wavelengths  ** c
c **                 that are used to recalculate grid radii for** c
c **                 fixed kernels. New input file              ** c
c **                'grid1.dat.new' will be created if key=1    ** c
c **                 or key_org=1. Use key_grid1 to choose      ** c
c **                 'grid1.dat' or 'grid1.dat.new' will be read** c
c **                 for further calculations                   ** c  
c **   key_SD=0 - read Size Distribution table (dV/dlnR)        ** c
c **         =1 - calculate Size Distribution for grid radii    ** c
c **              using Log Normal function                     ** c
c **   ID    - dimension of d(...)/dlnR                         ** c
c **       = 0 - number                                         ** c
c **       = 1 - radius                                         ** c
c **       = 2 - area                                           ** c
c **       = 3 - volume                                         ** c
c **   NMD   - number of modes (up to 2)                        ** c
c **   KN   - number of grid radii                              ** c
c **   grid(KN) - grid radii                                    ** c
c **   SD(KN)   - size distribution for grid radii              ** c
c **   (CM(i),SM(i),RMM(i),i=1,NMD) - size distribution         ** c
c **   function (LogNormal) parameters:                         ** c
c **                         CM - concentration                 ** c
c **                         SM - standard deviation            ** c
c **                         RMM - median radius                ** c
c **   distname_O - original kernel directory name              ** c
c **   distname_F - .fix kernel directory name                  ** c
c **   distname_N - new original kernel directory               ** c
c **                                         name (key_org=1)   ** c
c **   KR  - number of axis ratios                              ** c
c **   R(KR)  - grid axis ratios                                ** c
c **   RD(KR) - axis ratio distribution for grid axis ratios    ** c
c **   KM   - number of scattering angles                       ** c
c **   ANGLE(KM) - scattering angles                            ** c
c **                                                            ** c
c ** OUTPUT:                                                    ** c
c **                                                            ** c
c **   ext     - extinction                                     ** c
c **   albedo  - albedo                                         ** c
c **   f... - scattering matrix elements                        ** c
c **************************************************************** c
25                  ! KR   from Oleg's paper  (sum=2.; RD)              
0.3349	0.13237
0.3669	0.13005
0.4019	0.12727
0.4403	0.1241
0.4823	0.11744
0.5283	0.1067
0.5787	0.095525
0.6339	0.085906
0.6944	0.080641
0.7607	0.
0.8333	0.
0.9129	0.
1.	0.
1.0954	0.
1.2	0.
1.3145	0.
1.44	0.080641
1.5729	0.085906
1.728	0.095525
1.8929	0.1067
2.0736	0.11744
2.2715	0.1241
2.4883	0.12727
2.7258	0.13005
2.986	0.13237

1
1.0  1.
25                  ! KR    from Oleg's paper (sum=1.)            
0.3349  0.066185    
0.3669  0.065025
0.4019  0.063635
0.4403  0.06205  
0.4823  0.05872
0.5283  0.05335
0.5787  0.0477625
0.6339  0.042953
0.6944  0.0403205
0.7607  0.
0.8333  0.
0.9129  0.
1.      0.
1.0954  0.
1.2     0.
1.3145  0.
1.44    0.0403205
1.5774  0.042953
1.728   0.0477625
1.8929  0.05335
2.0736  0.05872
2.2715  0.06205
2.4883  0.063635
2.7258  0.065025
2.986   0.066185

KERNEL_n22_181
KERNEL_n22_fix
KERNEL_n22_new

2 
1.      0.000001
2.986   0.13237

2                  ! KR    from Oleg's paper (sum=1.)            
0.3349  0.066185    
2.986   0.066185

18                  ! KR    from Oleg's paper (sum=1.)            
0.3349  0.066185    
0.3669  0.065025
0.4019  0.063635
0.4403  0.06205  
0.4823  0.05872
0.5283  0.05335
0.5787  0.0477625
0.6339  0.042953
0.6944  0.0403205
1.44    0.0403205
1.5774  0.042953
1.728   0.0477625
1.8929  0.05335
2.0736  0.05872
2.2715  0.06205
2.48832 0.063635
2.7258  0.065025
2.986   0.066185


old axis ratio distributions *********** we do not use them any more
0.3349	0.078768
0.3669	0.063877
0.4019	0.044502
0.4403	0.027625
0.4823	0.01499
0.5283	0.0084396
0.5787	0.0051684
0.6339	0.0034341
0.6944	0.0024878
0.7607	0.001965
0.8333	0.0016961
0.9129	0.0016241
1	0.0017919
1.0954	0.0023427
1.2	0.0037166
1.3145	0.0071099
1.44	0.01733
1.5729	0.044698
1.728	0.16398
1.8929	0.13695
2.0736	0.13789
2.2715	0.089394
2.4883	0.052729
2.7258	0.045028
2.986	0.042463

0.3349	0.17437
0.3669	0.070026
0.4019	0.03396
0.4403	0.022417
0.4823	0.01605
0.5283	0.011479
0.5787	0.0080701
0.6339	0.0056174
0.6944	0.0040088
0.7607	0.0030036
0.8333	0.0024193
0.9129	0.0022033
1	0.0023668
1.0954	0.0030506
1.2	0.0047012
1.3145	0.0086044
1.44	0.019426
1.5729	0.047373
1.728	0.12741
1.8929	0.1232
2.0736	0.087893
2.2715	0.056125
2.4883	0.046207
2.7258	0.051982
2.986	0.06804
**************************** we do not use them any more
